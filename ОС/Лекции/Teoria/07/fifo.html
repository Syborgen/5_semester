<HTML>
<HEAD>
<title>Именованные каналы</title>
</HEAD>
<body>
	<h1>Именнованные каналы (FIFO)</h1> 
	<ul>
		<li><a href="#access">Доступ к именованному каналу</a></li>
		<li><a href="#diff">Отличия от именованных каналов Windows</a></li>
	</ul>	
	<p>	Именованный канал (<span class="term"> FIFO</span> ) - канал, который имеет 
		имя в файловой системе. Любой процесс может открыть или закрыть именованный
		канал; процессы на любом конце канала не должны быть связаны друг с другом. 
	<p>	Именованный канал создается с помощью команды <span class="term"> mkfifo.
		</span> Первый параметр команды - путь, по которому создается именованный 
		канал; второй параметр определяет владельца канала, группу, и права. 
		Так как в канале должны осуществляться и чтение и запись, то должны быть 
		права и на чтение и на запись. Если канал не может быть создан (например,
		если файл с этим именем уже существует), <span class="term"> mkfifo </span> 
		возвращается -1. Для использования команды <span class="term"> mkfifo </span> 
		необходимо подключить библиотеки <span class="term"> &lt;sys/types.h&gt; </span> 
		и <span class="term"> &lt;sys/stat.h&gt; </span> .
	<p>	 Пример создания именованного канала <span class="term"> /tmp/fifo</span> :
<pre>
	% mkfifo /tmp/fifo
	% ls -l /tmp/fifo
	prw-rw-rw- 1 samuel users 0 Jan 16 14:04 /tmp/fifo
</pre>
	<p>	Первый символ вывода команды <span class="term"> ls </span> p, показывает,  что это
		именованный канал. Для чтения именованогоканала, используется команда <span class="term"> 
		cat &lt; </span> :
<pre>
	% cat &lt; /tmp/fifo
</pre>
	<p>	В другой оболочке команда <span class="term"> cat &gt;</span>  открывает именованный
		канал для записи:
<pre>
	 % cat &gt; /tmp/fifo
</pre>
	<p>	В появившемся окне можно набирать текст. Каждый раз при нажатии Enter, строка текста 
		передается через именованный канал и появляется в первом окне. Для закрытия канала 
		используется сочетание Ctrl+D.
		Команда <span class="term"> rm</span> используется для удаления именованного канала:
<pre>
	% rm /tmp/fifo
</pre>
	<a name="access"></a>
	<h2>Доступ к именованному каналу</h2> 
	
	<p>	Обращение к именованному каналу осуществляется также как и к обычному файлу. 
		Чтобы общаться через именованный канал, одна программа должна открыть его 
		для записи, а другая программа должна открыть его для чтения. Могут использоваться
		любые функции ввода-вывода (<span class="func"> open, write, read, close, fopen,
		fprintf, fscanf, fclose </span> и др.).
	<p>	Пример использования низкоуровневых процедур ввода-вывода для записи буфера 
		данных в именованный канал:
<pre>
	int fd = open (fifo_path, O_WRONLY);
	write (fd, data, data_length);
	close (fd);
</pre>
	<p>	Пример использования функций ввода-вывода библиотеки <span class="term"> C </span> 
		для чтения строки из именованного канала:
<pre>
	FILE* fifo = fopen (fifo_path, "r");
	fscanf (fifo, "%s", buffer);
	fclose (fifo);
</pre>
	<p>	Именнованный канал может иметь несколько процессов чтения и записи. Байты от каждого 
		процесса записи атомарно записываются максимальным размером <span class="term"> 
		PIPE_BUF</span>  (4 КБ для <span class="term"> Linux</span>).
		Блоки от одновременно записывающих процессов могут быть чередованы. Подобные правила
		применяются и к процессам одновременного чтения.
	<a name="diff"></a>
	<h2>Отличия от именованных каналов Windows</h2>
	<p>	Каналы операционных систем <span class="term"> Win32 </span> подобны каналам
		<span class="term"> Linux</span> . Отличие заключается в том, что в <span class="term"> 
		Win32 </span> именованные каналы функционируют также как и сокеты. Именнованные каналы 
		<span class="term"> Win32 </span>  могут соединять процессы на различных компьютерах, 
		подключенных к сети. В <span class="term"> Linux </span> сокеты используются с той же
		целью. Однако <span class="term"> Win32</span>  позволяет множественные подключения 
		процессов записи в именованный канал, не чередуя данные, поэтому каналы могут
		использоваться для двухстороннего взаимодействия.  
</body>
